<link rel="stylesheet" type="text/css" href="widgets/plumb/css/plumb.css"/>
<!--<script type="text/javascript" src="widgets/plumb/js/jquery.keyframes.js"></script>-->
<script type="text/javascript">
    "use strict";

    if (vis.editMode) {
        $.extend(true, systemDictionary, {
            "group_conTop": {"en": "Connection top", "de": "Verbindung oben", "ru": "group_conTop"},
            "group_conBottom": {"en": "Connection bottom", "de": "Verbindung unten", "ru": "group_conBottom"},
            "group_conLeft": {"en": "Connection left", "de": "Verbindung links", "ru": "group_conLeft"},
            "group_conRight": {"en": "Connection right", "de": "Verbindung rechts", "ru": "group_conRight"}
        });


        $(document).keydown(function (e) {
            if (vis.binds.plumb.dragging) {
                $("#visview_" + vis.activeView).find(".plumb_dock_bottom, .plumb_dock_left, .plumb_dock_right, .plumb_dock_top").droppable("option", "disabled", true).removeClass("drop-hover");
                e.preventDefault();
            }
        });
    }


    vis.binds.plumb = {
        dragging: false,
        data: {},
        plumb_drop: function ($this, no_pos) {
            var drag_id;
            var self_id;
            var drop_cancel;
            if (vis.editMode) {

                $($this).find(".plumb_dock_top").droppable({
                    accept: ".pl_b:not(#" + $($this).attr("id") + ")",
                    hoverClass: "drop-hover",
                    tolerance: "touch",
                    drop: function (event, ui) {

                        drag_id = $(ui.draggable).attr("id");
                        self_id = $this.attr("id");
                        vis.views[vis.activeView].widgets[self_id].data.conTop = drag_id;
                        vis.views[vis.activeView].widgets[drag_id].data.conBottom = self_id;
                        $("#inspect_conBottom").val(self_id);
                        vis.save();
                        if (!no_pos && $("#" + drag_id).hasClass("pl_nocenter") == false) {
                            $(ui.draggable).css({
                                "top": $this.position().top - ui.draggable.height() + "px",
                                "left": $this.position().left + $(this).position().left - $(ui.draggable).find(".plumb_dock_bottom").position().left + (($(this).width() - $(ui.draggable).find(".plumb_dock_bottom").width()) /2 ) + "px"
                            });
                            $(".widget-helper").css({
                                "left": $this.position().left + $(this).position().left - $(ui.draggable).find(".plumb_dock_bottom").position().left + (($(this).width() - $(ui.draggable).find(".plumb_dock_bottom").width()) /2 ) - 1 + "px",
                                "top": $this.position().top - ui.draggable.height() - 1 + "px"
                            });
                        }
                        setTimeout(function () {
                            vis.reRenderWidgetEdit(drag_id);
                            vis.reRenderWidgetEdit(self_id);
                        }, 0)
                    }
                });
                $($this).find(".plumb_dock_bottom").droppable({
                    accept: ".pl_t:not(#" + $($this).attr("id") + ")",
                    hoverClass: "drop-hover",
                    tolerance: "touch",
                    drop: function (event, ui) {
                        drag_id = $(ui.draggable).attr("id");
                        self_id = $this.attr("id");
                        vis.views[vis.activeView].widgets[self_id].data.conBottom = drag_id;
                        vis.views[vis.activeView].widgets[drag_id].data.conTop = self_id;
                        $("#inspect_conTop").val(self_id);
                        vis.save();
                        if (!no_pos && $("#" + drag_id).hasClass("pl_nocenter") == false) {
                            $(ui.draggable).css({
                                "left": $this.position().left + $(this).position().left - $(ui.draggable).find(".plumb_dock_top").position().left + (($(this).width() - $(ui.draggable).find(".plumb_dock_top").width()) /2 ) + "px",
                                "top": $this.position().top + $this.height() + "px"
                            });
                            $(".widget-helper").css({
                                "left": $this.position().left + $(this).position().left - $(ui.draggable).find(".plumb_dock_top").position().left + (($(this).width() - $(ui.draggable).find(".plumb_dock_top").width()) /2 ) - 1 + "px",
                                "top": $this.position().top + $this.height() - 1 + "px"
                            });
                        }
                        setTimeout(function () {
                            vis.reRenderWidgetEdit(drag_id);
                            vis.reRenderWidgetEdit(self_id);
                        }, 0)
                    }
                });
                $($this).find(".plumb_dock_left").droppable({
                    accept: ".pl_r:not(#" + $($this).attr("id") + ")",
                    hoverClass: "drop-hover",
                    tolerance: "touch",
                    drop: function (event, ui) {
                        drag_id = $(ui.draggable).attr("id");
                        self_id = $this.attr("id");
                        vis.views[vis.activeView].widgets[self_id].data.conLeft = drag_id;
                        vis.views[vis.activeView].widgets[drag_id].data.conRight = self_id;
                        $("#inspect_conRight").val(self_id);
                        vis.save();
                        if (!no_pos && $("#" + drag_id).hasClass("pl_nocenter") == false) {

                            $(ui.draggable).css({
                                "left": $this.position().left - ui.draggable.width() + "px",
                                "top": $this.position().top + $(this).position().top - $(ui.draggable).find(".plumb_dock_right").position().top + (($(this).height() - $(ui.draggable).find(".plumb_dock_right").height()) /2 ) + "px"
                            });
                            $(".widget-helper").css({
                                "left": $this.position().left - ui.draggable.width() - 1 + "px",
                                "top": $this.position().top + $(this).position().top - $(ui.draggable).find(".plumb_dock_right").position().top + (($(this).height() - $(ui.draggable).find(".plumb_dock_right").height()) /2 ) - 1 + "px"
                            });
                        }
                        setTimeout(function () {
                            vis.reRenderWidgetEdit(drag_id);
                            vis.reRenderWidgetEdit(self_id);
                        }, 0)
                    }
                });
                $($this).find(".plumb_dock_right").droppable({
                    accept: ".pl_l:not(#" + $($this).attr("id") + ")",
                    hoverClass: "drop-hover",
                    tolerance: "touch",
                    drop: function (event, ui) {
                        drag_id = $(ui.draggable).attr("id");
                        self_id = $this.attr("id");
                        vis.views[vis.activeView].widgets[self_id].data.conRight = drag_id;
                        vis.views[vis.activeView].widgets[drag_id].data.conLeft = self_id;

                        $("#inspect_conLeft").val(self_id);
                        vis.save();
                        if (!no_pos && $("#" + drag_id).hasClass("pl_nocenter") == false) {

                            $(ui.draggable).css({
                                "left": $this.position().left + $this.width() + "px",
                                "top": $this.position().top + $(this).position().top - $(ui.draggable).find(".plumb_dock_left").position().top + (($(this).height() - $(ui.draggable).find(".plumb_dock_left").height()) /2 ) + "px"
                            });
                            $(".widget-helper").css({
                                "left": $this.position().left + $this.width() - 1 + "px",
                                "top": $this.position().top + $(this).position().top - $(ui.draggable).find(".plumb_dock_left").position().top + (($(this).height() - $(ui.draggable).find(".plumb_dock_left").height()) /2 ) - 1 + "px"
                            });
                        }
                        setTimeout(function () {
                            vis.reRenderWidgetEdit(drag_id);
                            vis.reRenderWidgetEdit(self_id);
                        }, 0)

                    }
                });
                $($this).find(".plumb_dock_center").droppable({
                    accept: ".pl:not(#" + $($this).attr("id") + ")",
                    hoverClass: "drop-hover",
                    tolerance: "touch",
                    drop: function (event, ui) {
                        console.log(event)
                        console.log(ui)
                        drag_id = $(ui.draggable).attr("id");
                        self_id = $this.attr("id");

                        var dl = ui.draggable[0].offsetLeft;
                        var dt = ui.draggable[0].offsetTop;
                        var dw = ui.draggable[0].offsetWidth;
                        var dh = ui.draggable[0].offsetHeight;
                        var cl = $this.position().left + ($this.width() / 2) - 10;
                        var ct = $this.position().top + ($this.height() / 2) - 10;


                        var data = {
                            left: (cl - dl - dw) * -1,
                            right: (dl - cl - 20) * -1,
                            top: (ct - dt - dh) * -1,
                            bottom: (dt - ct - 20) * -1
                        };

                        var ist = 9999;
                        var _ist;
                        $.each(data, function (key) {
                            if (this < ist) {
                                ist = this;
                                _ist = key;
                            }
                        });

                        if (_ist = "left") {
                            vis.views[vis.activeView].widgets[self_id].data.conLeft = drag_id;
                            vis.views[vis.activeView].widgets[drag_id].data.conRight = self_id;
                            $("#inspect_conRight").val(self_id);
                            vis.save();
                            if (!no_pos && $("#" + drag_id).hasClass("pl_nocenter") == false) {
                                $(ui.draggable).css({
                                    "left": $this.position().left - ui.draggable.width() + "px",
                                    "top": $this.position().top - (($(ui.draggable).height() - $this.height()) / 2 ) + "px"
                                });
                                $(".widget-helper").css({
                                    "left": $this.position().left - ui.draggable.width() - 1 + "px",
                                    "top": $this.position().top - (($(ui.draggable).height() - $this.height()) / 2 ) + "px"
                                });
                            }
                            setTimeout(function () {
                                vis.reRenderWidgetEdit(drag_id);
                                vis.reRenderWidgetEdit(self_id);
                            }, 0)
                        }
                        if (_ist = "right") {
                            vis.views[vis.activeView].widgets[self_id].data.conRight = drag_id;
                            vis.views[vis.activeView].widgets[drag_id].data.conLeft = self_id;

                            $("#inspect_conLeft").val(self_id);
                            vis.save();
                            if (!no_pos && $("#" + drag_id).hasClass("pl_nocenter") == false) {

                                $(ui.draggable).css({
                                    "left": $this.position().left + $this.width() + "px",
                                    "top": $this.position().top - (($(ui.draggable).height() - $this.height()) / 2 ) + "px"
                                });
                                $(".widget-helper").css({
                                    "left": $this.position().left + $this.width() - 1 + "px",
                                    "top": $this.position().top - (($(ui.draggable).height() - $this.height()) / 2 ) - 1 + "px"
                                });
                            }
                            setTimeout(function () {
                                vis.reRenderWidgetEdit(drag_id);
                                vis.reRenderWidgetEdit(self_id);
                            }, 0)

                        }
                        if (_ist = "top") {
                            vis.views[vis.activeView].widgets[self_id].data.conTop = drag_id;
                            vis.views[vis.activeView].widgets[drag_id].data.conBottom = self_id;
                            $("#inspect_conBottom").val(self_id);
                            vis.save();
                            if (!no_pos && $("#" + drag_id).hasClass("pl_nocenter") == false) {
                                $(ui.draggable).css({
                                    "left": $this.position().left - (($(ui.draggable).width() - $this.width()) / 2) + "px",
                                    "top": $this.position().top - ui.draggable.height() + "px"
                                });
                                $(".widget-helper").css({
                                    "left": $this.position().left - (($(ui.draggable).width() - $this.width()) / 2) - 1 + "px",
                                    "top": $this.position().top - ui.draggable.height() - 1 + "px"
                                });
                            }
                            setTimeout(function () {
                                vis.reRenderWidgetEdit(drag_id);
                                vis.reRenderWidgetEdit(self_id);
                            }, 0)
                        }
                        if (_ist = "bottom") {
                            vis.views[vis.activeView].widgets[self_id].data.conBottom = drag_id;
                            vis.views[vis.activeView].widgets[drag_id].data.conTop = self_id;
                            $("#inspect_conTop").val(self_id);
                            vis.save();
                            if (!no_pos && $("#" + drag_id).hasClass("pl_nocenter") == false) {
                                $(ui.draggable).css({
                                    "left": $this.position().left - (($(ui.draggable).width() - $this.width()) / 2) + "px",
                                    "top": $this.position().top + $this.height() + "px"
                                });
                                $(".widget-helper").css({
                                    "left": $this.position().left - (($(ui.draggable).width() - $this.width()) / 2) - 1 + "px",
                                    "top": $this.position().top + $this.height() - 1 + "px"
                                });
                            }
                            setTimeout(function () {
                                vis.reRenderWidgetEdit(drag_id);
                                vis.reRenderWidgetEdit(self_id);
                            }, 0)
                        }


//                        vis.views[vis.activeView].widgets[self_id].data.conRight = drag_id;
//                        vis.views[vis.activeView].widgets[drag_id].data.conLeft = self_id;
//
//                        $("#inspect_conLeft").val(self_id);
//                        vis.save();
//                        if (!no_pos && $("#"+drag_id).hasClass("pl_nocenter")== false) {
//
//                            $(ui.draggable).css({
//                                "left": $this.position().left + $this.width() + "px",
//                                "top": $this.position().top - (($(ui.draggable).height() - $this.height()) / 2 ) + "px"
//                            });
//                            $(".widget-helper").css({
//                                "left": $this.position().left + $this.width() - 1 + "px",
//                                "top": $this.position().top - (($(ui.draggable).height() - $this.height()) / 2 ) - 1 + "px"
//                            });
//                        }
//                        setTimeout(function () {
//                            vis.reRenderWidgetEdit(drag_id);
//                            vis.reRenderWidgetEdit(self_id);
//                        }, 0)

                    }
                });


                $this.on("dragstart", function (event, ui) {
                    vis.binds.plumb.dragging = true;
                    $("#visview_" + vis.activeView).find(".plumb_dock_bottom, .plumb_dock_left, .plumb_dock_right, .plumb_dock_top").droppable("option", "disabled", false);

                });

                $this.on("dragstop", function (event, ui) {
                    vis.binds.plumb.dragging = false;
                });


            }
        },
        check: function (id, event) {
            var data = {
                type: "plumb_change",
                from: event.from,
                color: event.color,
                status: event.status
            };

            var $this = $("#" + id);
            var plumb = vis.binds.plumb.data;
            var self = vis.binds.plumb.data[id];

            if (self.coli) {
                if (!event.status) {
                    vis.binds.plumb.rest_collision(id, data)
                }
            } else {
                if (event.status) {
                    if ((self.status == true && event.status == true && self.color.c != event.color.c && self.color.c_from != event.color.c_from)) {
                        vis.binds.plumb.set_collision(id)
                    } else {
                        if (self.color.c != event.color.c || self.color.c_from != event.color.c_from) {
                            vis.binds.plumb.set_normal(id, data)
                        }
                    }
                } else {

                    if (self.color.c != event.color.c || self.color.c_from != event.color.c_from) {
                        vis.binds.plumb.set_normal(id, data)
                    }


                }
            }

        },
        set_normal: function (id, event) {
            //console.log("set_normal")
            var $this = $("#" + id);
            var self = vis.binds.plumb.data[id];

            $($this).find(".plumb_body").css({
                "background-image": "none",
                "background-color": event.color.c
            });
            self.status = event.status;
            self.color = event.color;


            vis.binds.plumb.trigger(id, event)

        },
        set_collision: function (id) {
            console.log("set_collision")

            var $this = $("#" + id);
            var plumb = vis.binds.plumb.data;
            var self = vis.binds.plumb.data[id];
            self.status = true;
            self.coli = true;

            if (self.conLeft && self.conRight) {
                $($this).find(".plumb_body")
                        .css("background-image", "linear-gradient(to right, " + plumb[self.conLeft].color.c + " , " + plumb[self.conRight].color.c + ")")
                        .css("background-image", "-webkit-linear-gradient(to right, " + plumb[self.conLeft].color.c + " , " + plumb[self.conRight].color.c + ")");
            } else if (self.conTop && self.conBottom) {
                $($this).find(".plumb_body")
                        .css("background-image", "linear-gradient(" + plumb[self.conTop].color.c + " , " + plumb[self.conBottom].color.c + ")")
                        .css("background-image", "-webkit-linear-gradient(" + plumb[self.conTop].color.c + " , " + plumb[self.conBottom].color.c + ")")
            } else if (self.conTop && self.conRight) {
                console.log("background-image", "-webkit-linear-gradient(top left , " + plumb[self.conTop].color.c + " , " + plumb[self.conRight].color.c + ")")
                $($this).find(".plumb_body")
                        .css("background-image", "linear-gradient(top left , " + plumb[self.conTop].color.c + " , " + plumb[self.conRight].color.c + ")")
                        .css("background-image", "-webkit-linear-gradient(top left , " + plumb[self.conTop].color.c + " , " + plumb[self.conRight].color.c + ")")
            } else if (self.conTop && self.conLeft) {
                $($this).find(".plumb_body")
                        .css("background-image", "linear-gradient(right top, " + plumb[self.conTop].color.c + " , " + plumb[self.conLeft].color.c + ")")
                        .css("background-image", "-webkit-linear-gradient(right top, " + plumb[self.conTop].color.c + " , " + plumb[self.conLeft].color.c + ")")
            } else if (self.conBottom && self.conRight) {
                $($this).find(".plumb_body")
                        .css("background-image", "linear-gradient(left bottom, " + plumb[self.conBottom].color.c + " , " + plumb[self.conRight].color.c + ")")
                        .css("background-image", "-webkit-linear-gradient(left bottom, " + plumb[self.conBottom].color.c + " , " + plumb[self.conRight].color.c + ")")
            } else if (self.conBottom && self.conLeft) {
                $($this).find(".plumb_body")
                        .css("background-image", "linear-gradient(right bottom, " + plumb[self.conBottom].color.c + " , " + plumb[self.conRight].color.c + ")")
                        .css("background-image", "-webkit-linear-gradient(right bottom, " + plumb[self.conBottom].color.c + " , " + plumb[self.conRight].color.c + ")")
            }
        },
        rest_collision: function (id, event) {
            //console.log("reste_collision")
            var $this = $("#" + id);
            var plumb = vis.binds.plumb.data;
            var self = vis.binds.plumb.data[id];
            var e = JSON.parse(JSON.stringify(event));

            e.status = true;

            $.each(self.cons, function () {

                if (self[this] != event.from && self[this] != null ) {
                    e.color = plumb[self[this]].color;
                    self.color = e.color;
                }
            });

            $($this).find(".plumb_body").css({
                "background-image": "none",
                "background-color": e.color.c
            });

            vis.binds.plumb.trigger_b(id, e)
            self.coli = false;


        },
        trigger: function (id, event) {
            var self = vis.binds.plumb.data[id];
            var e = JSON.parse(JSON.stringify(event));

            $.each(self.cons, function () {

                if (self[this] != event.from) {
                    e.from = id;
                    $("#" + self[this]).trigger(e);
                }
            });


        },
        trigger_b: function (id, event) {
            var self = vis.binds.plumb.data[id];
            var e = JSON.parse(JSON.stringify(event));

            $.each(self.cons, function () {
                if (self[this] == event.from) {
                    e.from = id;
                    $("#" + self[this]).trigger(e);
                }
            });


        },

        pump: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pump",
                    cons: [],
                    coli: false,
                    from: id,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];
            self.cons = [];
            self.conLeft = data.conLeft || null;
            self.conRight = data.conRight || null;
            self.conTop = data.conTop || null;
            self.conBottom = data.conBottom || null;


            setTimeout(function () {

                $this.find(".plumb_dock_right, .plumb_dock_left, .plumb_dock_top, .plumb_dock_bottom").remove();
                var l;
                var t;
                var s;
                var shadow;

                if (data.conTop_show == true) {
                    self.cons.push("conTop");
                    $this.find(".pump").append('<div class="plumb_dock_top"></div>');
                    s = (data.conTop_size || 20);
                    t = "-10";
                    l = (($this.width() - s) / 100 * (data.conTop_pos || 50));
                    shadow = s / 2;
                    $this.find(".plumb_dock_top").css({
                        top: t + "px",
                        left: l + "px",
                        height: "20px",
                        width: s + "px",
                        background: "silver",
                        "box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000'
                    })
                }
                if (data.conBottom_show == true) {
                    self.cons.push("conBottom");
                    $this.find(".pump").append('<div class="plumb_dock_bottom"></div>');
                    s = (data.conBottom_size || 20);
                    t = "-10";
                    l = (($this.width() - s) / 100 * (data.conBottom_pos || 50));
                    shadow = s / 2;
                    $this.find(".plumb_dock_bottom").css({
                        bottom: t + "px",
                        left: l + "px",
                        height: "20px",
                        width: s + "px",
                        background: "silver",
                        "box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000'
                    })
                }
                if (data.conLeft_show == true) {
                    self.cons.push("conLeft")
                    $this.find(".pump").append('<div class="plumb_dock_left"></div>');
                    s = (data.conLeft_size || 20);
                    l = "-10";
                    t = (($this.height() - s) / 100 * (data.conLeft_pos || 50));
                    shadow = s / 2;
                    $this.find(".plumb_dock_left").css({
                        top: t + "px",
                        left: l + "px",
                        height: s + "px",
                        width: "20px",
                        background: "silver",
                        "box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'
                    })
                }
                if (data.conRight_show == true) {
                    self.cons.push("conRight")
                    $this.find(".pump").append('<div class="plumb_dock_right"></div>');
                    s = (data.conRight_size || 20);
                    l = "-10";
                    t = (($this.height() - s) / 100 * (data.conRight_pos || 50));
                    shadow = s / 2;
                    $this.find(".plumb_dock_right").css({
                        top: t + "px",
                        right: l + "px",
                        height: s + "px",
                        width: "20px",
                        background: "silver",
                        "box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'
                    })
                }

                vis.binds.plumb.plumb_drop($this);
            });


            $this.bind("plumb_change", function (event) {

                if (vis.states[data.oid + '.val'] >= 1) {
                    //console.log("pump_change");
                    //console.log(event)
                    var ev = {
                        type: "plumb_change",
                        from: id,
                        status: true,
                        color: {
                            c_from: id,
                            c_default: data.color_off,
                            c: data.color_on
                        }
                    };
                    ev.color.c = data.color_on;
                    ev.status = true;
                    self.color = ev.color,
                            $("#" + event.from).trigger(ev);
                }

            });

            vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {
                vis.binds.plumb.stop = 0;
                var ev = {
                    type: "plumb_change",
                    from: id,
                    color: {
                        c_from: id,
                        c_default: data.color_off
                    }
                };
                if (newVal >= 1) {
                    ev.color.c = data.color_on;
                    ev.status = true
                } else {
                    ev.color.c = data.color_off;
                    ev.status = false
                }
                self.color = ev.color;
                $.each(self.cons, function () {
              $this.find(".plumb_dock_right, .plumb_dock_left, .plumb_dock_top, .plumb_dock_bottom").css("background",ev.color.c);
                    if ($("#" + self[this])) {
                        $("#" + self[this]).trigger(ev);
                    }


                });
            });

            setTimeout(function () {
                //console.log("hallo")
                var ev = {
                    type: "plumb_change",
                    from: id,
                    color: {
                        c_from: id,
                        c_default: data.color_off
                    }
                };
                if (vis.states[data.oid + '.val'] >= 1) {
                    ev.color.c = data.color_on;
                    ev.status = true
                } else {
                    ev.color.c = data.color_off;
                    ev.status = false
                }
                self.color = ev.color;
                $.each(self.cons, function () {
                    $this.find(".plumb_dock_right, .plumb_dock_left, .plumb_dock_top, .plumb_dock_bottom").css("background",ev.color.c);
                    if ($("#" + self[this])) {
                        $("#" + self[this]).trigger(ev);
                    }
                });
            },2);

        },
        sprinkler_i: function (el, data) {
            var $this = $(el).parent();
            var $head = $(el);
            var $wp = $this.find(".plumb_sprinkler_i");
            var $water = $this.find(".plumb_sprinkler_i_water");
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pump",
                    cons: ["conTop", "conBottom", "conLeft", "conRight"],
                    coli: false,
                    from: id,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null
                }
            }
            var self = plumb[id];

            self.conLeft = data.conLeft || null;
            self.conRight = data.conRight || null;
            self.conTop = data.conTop || null;
            self.conBottom = data.conBottom || null;
            $this.css("overflow", "visible");

            vis.binds.plumb.plumb_drop($this);

            $($this).on("resize", function () {
                set()
            });

            $this.bind("plumb_change", function (event) {
                self.status = event.status;
                if (event.status == true) {
                    $wp.show();
                    $head.css({
                        "background-color": data.head_color
                    });
                } else {
                    $wp.hide();
                    if (data["head-show"] == false) {
                        $head.css({
                            "background-color": "transparent"
                        });
                    }
                }
            });

            function set() {
                $('#' + id + '_style').remove();

                $('<style id="' + id + '_style">\
                @-webkit-keyframes ' + id + '-ANIMATION {\
                    0%   { -webkit-transform: rotate(' + data.start + 'deg);}\
                    80%  { -webkit-transform: rotate(' + data.ende + 'deg);}\
                    100% { -webkit-transform: rotate(' + data.start + 'deg);}\
                }\
                @keyframes ' + id + '-ANIMATION {\
                    0%   { transform: rotate(' + data.start + 'deg);}\
                    80%  { transform: rotate(' + data.ende + 'deg); }\
                    100% { transform: rotate(' + data.start + 'deg);}\
                }\
                <style>').appendTo("head");


                $wp.css({
                    "-webkit-animation": id + "-ANIMATION " + data.time + "s infinite linear",
                    "animation": id + "-ANIMATION " + data.time + "s infinite linear"
                });
                $water.css({
                    height: data.width + "px",
                    width: data.stroke + "px",
                    left: parseInt($($wp).width() / 2 - data.stroke / 2) + "px",
                    top: parseInt($($wp).height() / 2 - data.width) + "px",
                    position: "relative",
                    "background-color": data.water_color,
                    opacity: data.opacity,
                    "border-radius": "100px"
                });


                if (data.fog == true) {
                    $water.css({
                        "box-shadow": '0px 0px ' + (data.stroke * 2) + 'px ' + data.stroke + 'px ' + data.water_color
                    })
                }

                if (data.head_round == "true" || data.head_round == true) {
                    $head.css({
                        "border-radius": "100%"
                    });
                }

                if (self.status == true || (vis.editMode == true && data.test == true)) {
                    $wp.show()
                } else {
                    $wp.hide()
                }

                if ((self.status == true || data.head_show == "true" || data.head_show == true ) || (vis.editMode == true && data.test == "true")) {
                    $head.css({
                        "background-color": data.head_color
                    });
                } else {
                    $head.css({
                        "background-color": "pransparent"
                    });
                }
            }

            setTimeout(function () {
                set()
            })


        },
        sprinkler_r: function (el, data) {
            var $this = $(el).parent();
            var $head = $(el);
            var $wp = $this.find(".plumb_sprinkler_r");
            var $water = $this.find(".plumb_sprinkler_r_water");
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pump",
                    cons: ["conTop", "conBottom", "conLeft", "conRight"],
                    coli: false,
                    from: id,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null
                }
            }
            var self = plumb[id];

            self.conLeft = data.conLeft || null;
            self.conRight = data.conRight || null;
            self.conTop = data.conTop || null;
            self.conBottom = data.conBottom || null;

            vis.binds.plumb.plumb_drop($this);

            $($this).on("resize", function () {
                set()
            });

            $this.bind("plumb_change", function (event) {
                self.status = event.status;
                if (event.status == true) {
                    $wp.show();
//                    $head.css({
//                        "background-color": data.head_color
//                    });
                } else {
                    $wp.hide();
                    if (data["head-show"] == false) {
//                        $head.css({
//                            "background-color": "transparent"
//                        });
                    }
                }
            });

            function set() {
                var time = data.time || 36;
                var start = data.start || 0;
                var end = data.ende || 180;
                var stroke = data.stroke || 10;
                var top = 0;
                var left = 0;
                var width = "200%";

                if (data.position == "top-center") {
                    width = "100%";
                    top = ($this.height() / 2) * -1;
                    left = 0
                } else if (data.position == "bottom-center") {
                    width = "100%";
                    top = ($this.width() / 2);
                    left = 0
                } else if (data.position == "left-center") {
                    width = "100%";
                    top = ($this.height() / 2) * -1;
                    left = ($this.width()) * -1
                } else if (data.position == "right-center") {
                    width = "100%";
                    left = ($this.width() / 2)
                } else if (data.position == "top-left") {
                    top = ($this.height() / 2) * -1;
                    left = ($this.width() / 2) * -1
                } else if (data.position == "top-right") {
                    top = ($this.height() / 2) * -1;
                    left = ($this.width() / 2)
                } else if (data.position == "bottom-left") {
                    top = 0;
                    left = ($this.width()) * -1
                } else if (data.position == "bottom-right") {
                    top = 0;
                    left = 0
                } else if (data.position == "center") {
                    width = "100%"
                }


                $water.css({
                    top: top + "px",
                    left: left + "px",
                    height: width,
                    width: width
                });

                var _turn_winkel = start * Math.PI / 180;
                var r = 250;
                var x1 = 250 + r * Math.sin(_turn_winkel);
                var y1 = 250 - r * Math.cos(_turn_winkel);
                var winkel_max = (start - end) * -1;
                var x2 = 250 + r * Math.sin(end * Math.PI / 180);
                var y2 = 250 - r * Math.cos(end * Math.PI / 180);

                if ((end - start) < 180) {

                    var p = "M" + x1 + "," + y1 + " A" + r + "," + r + " 0 0,1 " + x2 + "," + y2 + "L 250 250 z";
                } else {
                    var p = "M" + x1 + "," + y1 + " A" + r + "," + r + " 0 1,1 " + x2 + "," + y2 + " L 250 250 z"
                }

                $("#" + id + "_svg").remove();
                $water.append('\
                <svg\
                xmlns:svg="http://www.w3.org/2000/svg"\
                xmlns="http://www.w3.org/2000/svg"\
                id = "' + id + '_svg"\
                width="100%"\
                height="100%"\
                viewBox="0 0 500 500"\
                >\
           <clipPath id="starfoo">\
                <path d="' + p + '"/>\
                </clipPath>\
                    <g\
                     <g\
            transform="translate(0,0)" clip-path="url(#starfoo)">\
                        <g style="stroke:#0000ff;stroke-width:' + stroke + ';stroke-linecap:round;stroke-opacity:0.5" >\
                        <path d="M 250,500 250,0"/>\
                        <path d="M 293,496 207,3.8"/>\
                        <path d="M 335,485 165,14.7"/>\
                        <path d="M 375,467 125,33"/>\
                        <path d="M 411,442 89.2,58"/>\
                        <path d="M 442,411 58.3,88.9"/>\
                        <path d="M 467,375 33.2,125"/>\
                        <path d="M 485,335 14.8,165"/>\
                        <path d="M 496,293 3.61,207"/>\
                        <path d="M 500,250 -0.117,250"/>\
                        <path d="M 496,207 3.68,293"/>\
                        <path d="M 485,165 14.9,335"/>\
                        <path d="M 467,125 33.2,375"/>\
                        <path d="M 442,89.2 58.2,411"/>\
                        <path d="M 411,58.3 89.1,442"/>\
                        <path d="M 375,33.3 125,467"/>\
                        <path d="M 335,14.9 165,485"/>\
                        <path d="M 293,3.71 207,496"/>\
                                <animateTransform id="t_two" attributeName="transform" type="rotate" from="0 250 250" to=" 360 250 250" begin="0s" dur="' + time + '" repeatCount="indefinite"   />\
                        </g>\
                    </g>\
                    <circle cx="250" cy="250" r="8"  fill="black"  />\
                </svg>\
            ')
            }

            setTimeout(function () {
                set()
            })


        },
        pipe_h: function (el, conLeft, conRight) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conLeft", "conRight"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];

            self.conLeft = conLeft || null;
            self.conRight = conRight || null;

            $($this).on("resize", function () {
                var shadow = parseInt($this.height() / 2);
                $($this).find(".pipe_h").css({"box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'})
            });

            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {
//console.log(self.color.c + " --- "+ event.color.c)
                //console.log(self.color.c_from + " --- "+ event.color.c_from)
                vis.binds.plumb.check(id, event)
            });

        },
        pipe_v: function (el, conTop, conBottom) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conTop", "conBottom"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];


            self.conTop = conTop || null;
            self.conBottom = conBottom || null;

            $($this).on("resize", function () {
                var shadow = parseInt($this.width() / 2);
                $($this).find(".pipe_v").css({"box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000'})
            });

            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {
//                //console.log(event)
                vis.binds.plumb.check(id, event)
            });

        },
        bogen_br: function (el, conBottom, conRight) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conRight", "conBottom"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];


            self.conRight = conRight || null;
            self.conBottom = conBottom || null;

            $($this).on("resize", function () {
                var shadow = parseInt($this.width() / 2);
                $($this).find(".bogen_br").css({"box-shadow": 'inset ' + shadow / 2 + 'px ' + shadow / 2 + 'px ' + shadow + 'px -' + parseInt((shadow / 2) + 1) + 'px #000 '});
                $($this).find(".bogen_br_shadow").css({"box-shadow": '-' + parseInt(shadow / 2 / 2) + 'px -' + parseInt(shadow / 2 / 2) + 'px ' + shadow + 'px #000 '});
            });

            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {
                vis.binds.plumb.check(id, event)

//                $($this).find(".bogen_br").css("background-color", event.color);
//                var e = {
//                    type: "plumb_change",
//                    from: id,
//                    color: event.color,
//                    default: event.default
//                };
//                if (conBottom == event.from) {
//                    $("#" + conRight).trigger(e);
//                } else {
//                    $("#" + conBottom).trigger(e);
//                }
            })
        },
        bogen_bl: function (el, conBottom, conLeft) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conLeft", "conBottom"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];

            self.conLeft = conLeft || null;
            self.conBottom = conBottom || null;

            $($this).on("resize", function () {
                var shadow = parseInt($this.width() / 2);
                $($this).find(".bogen_bl").css({"box-shadow": 'inset -' + shadow / 2 + 'px ' + shadow / 2 + 'px ' + shadow + 'px -' + parseInt((shadow / 2) + 1) + 'px #000 '});
                $($this).find(".bogen_bl_shadow").css({"box-shadow": '' + parseInt(shadow / 2 / 2) + 'px -' + parseInt(shadow / 2 / 2) + 'px ' + shadow + 'px #000 '});
            });

            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {
                vis.binds.plumb.check(id, event)

//                $($this).find(".bogen_bl").css("background-color", event.color);
//                var e = {
//                    type: "plumb_change",
//                    from: id,
//                    color: event.color,
//                    default: event.default
//                };
//                if (conBottom == event.from) {
//                    $("#" + conLeft).trigger(e);
//                } else {
//                    $("#" + conBottom).trigger(e);
//                }
            })
        },
        bogen_tr: function (el, conTop, conRight) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conRight", "conTop"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];


            self.conRight = conRight || null;
            self.conTop = conTop || null;

            $($this).on("resize", function () {
                var shadow = parseInt($this.width() / 2);
                $($this).find(".bogen_tr").css({"box-shadow": 'inset ' + shadow / 2 + 'px -' + shadow / 2 + 'px ' + shadow + 'px -' + parseInt((shadow / 2) + 1) + 'px #000 '});
                $($this).find(".bogen_tr_shadow").css({"box-shadow": '-' + parseInt(shadow / 2 / 2) + 'px ' + parseInt(shadow / 2 / 2) + 'px ' + shadow + 'px #000 '});
            });

            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {
                vis.binds.plumb.check(id, event);
//                $($this).find(".bogen_tr").css("background-color", event.color);
//                var e = {
//                    type: "plumb_change",
//                    from: id,
//                    color: event.color,
//                    default: event.default
//                };
//                if (conTop == event.from) {
//                    $("#" + conRight).trigger(e);
//                } else {
//                    $("#" + conTop).trigger(e);
//                }
            })
        },
        bogen_tl: function (el, conTop, conLeft) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conLeft", "conTop"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];

            self.conLeft = conLeft || null;
            self.conTop = conTop || null;
            $($this).on("resize", function () {
                var shadow = parseInt($this.width() / 2);
                $($this).find(".bogen_tl").css({"box-shadow": 'inset -' + shadow / 2 + 'px -' + shadow / 2 + 'px ' + shadow + 'px -' + parseInt((shadow / 2) + 1) + 'px #000 '});
                $($this).find(".bogen_tl_shadow").css({"box-shadow": '' + parseInt(shadow / 2 / 2) + 'px ' + parseInt(shadow / 2 / 2) + 'px ' + shadow + 'px #000 '});
            });

            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {
                vis.binds.plumb.check(id, event);
//                $($this).find(".bogen_tl").css("background-color", event.color);
//                var e = {
//                    type: "plumb_change",
//                    from: id,
//                    color: event.color,
//                    default: event.default
//                };
//                if (conTop == event.from) {
//                    $("#" + conLeft).trigger(e);
//                } else {
//                    $("#" + conTop).trigger(e);
//                }
            })
        },
        valve_h: function (el, oid, conLeft, conRight, ctrl) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;
            var self_color;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conLeft", "conRight"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];


            self.conLeft = conLeft || null;
            self.conRight = conRight || null;

            $($this).on("resize", function () {
                var height = $this.height();
                $($this).find(".plumb_valve_l").css({
                    "border-width": '' + height / 2 + 'px 0px ' + height / 2 + 'px ' + height + 'px',
                    "border-color": 'rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)' + self_color
                });
                $($this).find(".plumb_valve_r").css({
                    "border-width": '' + height / 2 + 'px ' + height + 'px ' + height / 2 + 'px  0px ',
                    "border-color": 'rgba(0, 0, 0, 0) ' + self_color + ' rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) '
                })

            });

            vis.binds.plumb.plumb_drop($this);

            $($this).click(function () {
                if (ctrl) {
                    if (vis.states[oid + '.val'] >= 1) {
                        vis.setValue(oid, 0);
                    } else {
                        vis.setValue(oid, 1);
                    }
                }
            });

            $this.bind("plumb_change", function (event) {

                if (vis.states[oid + '.val'] >= 1) {
                    vis.binds.plumb.check(id, event)
                }
            });

            function set(newVal) {
                var ev = {
                    type: "plumb_change",
                    from: id,
                    status: true
                };

                if (newVal >= 1) {

                    self_color = "#0F0";
                    $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                    $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"})

                    if (plumb[self.conLeft].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conLeft].color));
                        self.color = ev.color;

                        $("#" + conRight).trigger(ev);
                    }

                    if (plumb[self.conRight].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        self.color = ev.color;

                        $("#" + conLeft).trigger(ev);
                    }

                } else {

                    self_color = "#F00";
                    $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                    $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"})

                    if (plumb[self.conLeft].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conLeft].color));

                        ev.color.c = ev.color.c_default;
                        ev.status = false;
                        self.color = ev.color;


                        $("#" + conLeft).trigger(ev);
                    }

                    if (plumb[self.conRight].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        ev.color.c = ev.color.c_default;
                        ev.status = false;
                        self.color = ev.color;
                        $("#" + conRight).trigger(ev);
                    }
                }
            }

            vis.states.bind(oid + '.val', function (e, newVal, oldVal) {
                set(newVal)
            });

            if (vis.states[oid + '.val'] >= 1) {
                self_color = "#0F0";
                $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"})
            } else {
                self_color = "#F00";
                $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"})
            }
        },
        valve_v: function (el, oid, conTop, conBottom, ctrl) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;
            var self_color;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conTop", "conBottom"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];


            self.conTop = conTop || null;
            self.conBottom = conBottom || null;

            $($this).on("resize", function () {
                var width = $this.width();
                $($this).find(".plumb_valve_t").css({
                    "border-width": '' + width + 'px ' + width / 2 + 'px 0px  ' + width / 2 + 'px',
                    "border-color": self_color + '  rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)'
                });
                $($this).find(".plumb_valve_b").css({
                    "border-width": '0px ' + width / 2 + 'px ' + width + 'px ' + width / 2 + 'px   ',
                    "border-color": 'rgba(0, 0, 0, 0)  rgba(0, 0, 0, 0) ' + self_color + ' rgba(0, 0, 0, 0) '
                })

            });

            vis.binds.plumb.plumb_drop($this);

            $($this).click(function () {
                if (ctrl) {
                    if (vis.states[oid + '.val'] >= 1) {
                        vis.setValue(oid, 0);
                    } else {
                        vis.setValue(oid, 1);
                    }
                }
            });

            $this.bind("plumb_change", function (event) {

                if (vis.states[oid + '.val'] >= 1) {
                    vis.binds.plumb.check(id, event)
                }
            });

            function set(newVal) {

                if (newVal >= 1) {

                    self_color = "#0F0";
                    $this.find(".plumb_valve_t").css({"border-color": self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) "});
                    $this.find(".plumb_valve_b").css({"border-color": 'rgba(0, 0, 0, 0)  rgba(0, 0, 0, 0) ' + self_color + ' rgba(0, 0, 0, 0) '})
                } else {

                    self_color = "#F00";
                    $this.find(".plumb_valve_t").css({"border-color": self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) "});
                    $this.find(".plumb_valve_b").css({"border-color": 'rgba(0, 0, 0, 0)  rgba(0, 0, 0, 0) ' + self_color + ' rgba(0, 0, 0, 0) '})
                }


                var ev = {
                    type: "plumb_change",
                    from: id,
                    status: true
                };

                if (plumb[self.conTop].status) {
                    ev.color = JSON.parse(JSON.stringify(plumb[self.conTop].color));
                    self.color = ev.color;
                    self.color_from = ev.color_from;

                    //console.log(ev)
                    $("#" + conBottom).trigger(ev);
                }

                if (plumb[self.conBottom].status) {
                    ev.color = JSON.parse(JSON.stringify(plumb[self.conBottom].color));
                    self.color = ev.color;
                    //console.log(ev)
                    $("#" + conTop).trigger(ev);
                }

            }

            vis.states.bind(oid + '.val', function (e, newVal, oldVal) {
                set(newVal)
            });

            if (vis.states[oid + '.val'] >= 1) {
                self_color = "#0F0";
                $this.find(".plumb_valve_t").css({"border-color": self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) "});
                $this.find(".plumb_valve_b").css({"border-color": 'rgba(0, 0, 0, 0)  rgba(0, 0, 0, 0) ' + self_color + ' rgba(0, 0, 0, 0) '})
            } else {
                self_color = "#F00";
                $this.find(".plumb_valve_t").css({"border-color": self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) "});
                $this.find(".plumb_valve_b").css({"border-color": 'rgba(0, 0, 0, 0)  rgba(0, 0, 0, 0) ' + self_color + ' rgba(0, 0, 0, 0) '})
            }
        },
        c_valve_h: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;
            var self_color;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conLeft", "conRight"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];


            self.conLeft = data.conLeft || null;
            self.conRight = data.conRight || null;

            $($this).on("resize", function () {
                var height = $this.height();
                var shadow = height / 2;
                var symbol = "none";

                if (data.symbol != "" && data.symbol != undefined){
                    symbol =  'url('+data.symbol+')'
                }
                $($this).find(".plumb_c_valve_h_img").css({
                    background: symbol
                });

                if(data.turn_direction == true || data.turn_direction == "true"){
                    $($this).find(".plumb_c_valve_h_img").css({
                    "-moz-transform": "scaleX(-1)",
                    "-o-transform": "scaleX(-1)",
                    "-webkit-transform": "scaleX(-1)",
                    "transform": "scaleX(-1)"
                    })
                }

                if(data.show_back == true || data.show_back == "true" ) {


                    $($this).find(".plumb_c_valve_h_back_l, .plumb_c_valve_h_back_r").css({
                        display: "block",
                        width: "50%",
                        height: "100%",
                        position: "absolute",
                        background: "silver",
                        "box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'
                    });
                }
                else{

                    $($this).find(".plumb_c_valve_h_back_l, .plumb_c_valve_h_back_r").css({
                        display: "none",
                        width: "50%",
                        height: "100%",
                        position: "absolute",
                        background: "silver",
                        "box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'
                    });
                }
            });

            $($this).trigger("resize")

            $($this).find(".plumb_c_valve_h_back_r").css({right: "0px"});

            vis.binds.plumb.plumb_drop($this);


            $this.bind("plumb_change", function (event) {

                if (self.conLeft == event.from && data.turn_direction == false) {
                    $($this).find(".plumb_c_valve_h_back_l, .plumb_c_valve_h_back_r").css("background", event.color.c)
                    vis.binds.plumb.check(id, event)
                }else if (self.conLeft == event.from) {
                    $($this).find(".plumb_c_valve_h_back_l").css("background", event.color.c)
                }

                if (self.conRight == event.from && data.turn_direction != false) {
                    $($this).find(".plumb_c_valve_h_back_l, .plumb_c_valve_h_back_r").css("background", event.color.c)
                    vis.binds.plumb.check(id, event)
                }else if (self.conRight == event.from){
                    $($this).find(".plumb_c_valve_h_back_r").css("background", event.color.c)
                }

            });

            function set(newVal) {
                var ev = {
                    type: "plumb_change",
                    from: id,
                    status: true
                };

                if (newVal >= 1) {

                    self_color = "#0F0";
                    $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                    $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"})


                    if (plumb[self.conLeft].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conLeft].color));
                        self.color = ev.color;

                        $("#" + data.conRight).trigger(ev);
                    }

                    if (plumb[self.conRight].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        self.color = ev.color;

                        $("#" + data.conLeft).trigger(ev);
                    }

                } else {

                    self_color = "#F00";
                    $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                    $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"})

                    if (plumb[self.conLeft].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conLeft].color));

                        ev.color.c = ev.color.c_default;
                        ev.status = false;
                        self.color = ev.color;

                        $("#" + data.conLeft).trigger(ev);
                    }

                    if (plumb[self.conRight].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        ev.color.c = ev.color.c_default;
                        ev.status = false;
                        self.color = ev.color;
                        $("#" + data.conRight).trigger(ev);
                    }
                }
            }
        },
        c_valve_v: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;
            var self_color;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conTop", "conBottom"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];


            self.conTop = data.conTop || null;
            self.conBottom = data.conBottom || null;

            $($this).on("resize", function () {
                var width = $this.width();
                var shadow = width / 2;
                var symbol = "none";

                if (data.symbol != "" && data.symbol != undefined){
                    symbol =  'url('+data.symbol+')'
                }
                $($this).find(".plumb_c_valve_v_img").css({
                    background: symbol
                });

                if(data.turn_direction == true || data.turn_direction == "true"){
                    $($this).find(".plumb_c_valve_v_img").css({
                        "-moz-transform": "scaleY(-1)",
                        "-o-transform": "scaleY(-1)",
                        "-webkit-transform": "scaleY(-1)",
                        "transform": "scaleY(-1)"
                    })
                }

                if(data.show_back == true || data.show_back == "true" ) {
                    $($this).find(".plumb_c_valve_v_back_t, .plumb_c_valve_v_back_b").css({
                        display: "block",
                        "box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000'
                    });
                }
                else{

                    $($this).find(".plumb_c_valve_v_back_t, .plumb_c_valve_v_back_b").css({
                        display: "none",
                        "box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'
                    });
                }
            });

            $($this).trigger("resize");

            $($this).find(".plumb_c_valve_h_back_r").css({right: "0px"});

            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {

                if (self.conTop == event.from && data.turn_direction == false) {
                    $($this).find(".plumb_c_valve_v_back_t, .plumb_c_valve_v_back_b").css("background", event.color.c)
                    vis.binds.plumb.check(id, event)
                }else if (self.conTop == event.from) {
                    $($this).find(".plumb_c_valve_v_back_t").css("background", event.color.c)
                }

                if (self.conBottom == event.from && data.turn_direction != false) {
                    $($this).find(".plumb_c_valve_v_back_t, .plumb_c_valve_v_back_b").css("background", event.color.c)
                    vis.binds.plumb.check(id, event)
                }else if (self.conBottom== event.from){
                    $($this).find(".plumb_c_valve_v_back_b").css("background", event.color.c)
                }
            });

            function set(newVal) {
                var ev = {
                    type: "plumb_change",
                    from: id,
                    status: true
                };

                if (newVal >= 1) {

                    self_color = "#0F0";
                    $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                    $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"})


                    if (plumb[self.conLeft].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conLeft].color));
                        self.color = ev.color;
                        $("#" + data.conRight).trigger(ev);
                    }

                    if (plumb[self.conRight].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        self.color = ev.color;
                        $("#" + data.conLeft).trigger(ev);
                    }
                } else {

                    self_color = "#F00";
                    $this.find(".plumb_valve_l").css({"border-color": "rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) " + self_color});
                    $this.find(".plumb_valve_r").css({"border-color": "rgba(0, 0, 0, 0) " + self_color + " rgba(0, 0, 0, 0) rgba(0, 0, 0, 0)"})

                    if (plumb[self.conLeft].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conLeft].color));

                        ev.color.c = ev.color.c_default;
                        ev.status = false;
                        self.color = ev.color;

                        $("#" + data.conLeft).trigger(ev);
                    }

                    if (plumb[self.conRight].status) {
                        ev.color = JSON.parse(JSON.stringify(plumb[self.conRight].color));
                        ev.color.c = ev.color.c_default;
                        ev.status = false;
                        self.color = ev.color;
                        $("#" + data.conRight).trigger(ev);
                    }
                }
            }
        },
        tpice_ht: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conLeft", "conRight", "conTop"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];

            self.conLeft = data.conLeft || null;
            self.conRight = data.conRight || null;
            self.conTop = data.conTop || null;

            $($this).on("resize", function () {
                var size = Math.round($this.height() / 3);
                var shadow = parseInt($this.height() / 3 / 2);
                $($this).find(".tpice-hl").css({"box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'});
                $($this).find(".tpice-hm").css({"box-shadow": 'inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'});
                $($this).find(".tpice-hr").css({"box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'});

                $($this).find(".bogen_tl_shadow").css({"box-shadow": '0px 0px ' + parseInt(shadow / 1.33) + 'px ' + parseInt(shadow / 4) + 'px #000 '});
                $($this).find(".bogen_tr_shadow").css({"box-shadow": '0px 0px ' + parseInt(shadow / 1.33) + 'px ' + parseInt(shadow / 4) + 'px#000 '});

                $($this).find(".tpice-t").css({"box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000'});

                $($this).find(".tpice-t, .tpice-hr, .tpice-hm, .tpice-hl").css({
                    height: size + "px",
                    width: size + "px"
                });

                $($this).find(" .bogen_tr_shadow").css({
                    height: shadow + "px",
                    width: shadow + "px",
                    right: "-" + shadow - 1 + "px",
                    top: "-" + shadow - 1 + "px"
                })
                $($this).find(".bogen_tl_shadow").css({
                    height: shadow + "px",
                    width: shadow + "px",
                    left: "-" + shadow - 1 + "px",
                    top: "-" + shadow - 1 + "px"
                })
            });

            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {
//console.log(self.color.c + " --- "+ event.color.c)
                //console.log(self.color.c_from + " --- "+ event.color.c_from)
                vis.binds.plumb.check(id, event)
            });

        },
        tpice_hb: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conLeft", "conRight", "conBottom"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];

            self.conLeft = data.conLeft || null;
            self.conRight = data.conRight || null;
            self.conBottom = data.conBottom || null;

            $($this).on("resize", function () {
                var size = Math.round($this.height() / 3);
                var shadow = parseInt($this.height() / 3 / 2);
                $($this).find(".tpice-hl").css({"box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'});
                $($this).find(".tpice-hm").css({"box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'});
                $($this).find(".tpice-hr").css({"box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'});

                $($this).find(".bogen_bl_shadow").css({"box-shadow": '0px 0px ' + parseInt(shadow / 1) + 'px ' + parseInt(shadow / 5) + 'px #000 '});
                $($this).find(".bogen_br_shadow").css({"box-shadow": '0px 0px ' + parseInt(shadow / 1) + 'px ' + parseInt(shadow / 5) + 'px#000 '});

                $($this).find(".tpice-b").css({"box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000'});

                $($this).find(".tpice-b, .tpice-hr, .tpice-hm, .tpice-hl").css({
                    height: size + "px",
                    width: size + "px"
                });

                $($this).find(" .bogen_br_shadow").css({
                    height: shadow + "px",
                    width: shadow + "px",
                    right: "-" + shadow - 1 + "px",
                    top: size + "px"
                });
                $($this).find(".bogen_bl_shadow").css({
                    height: shadow + "px",
                    width: shadow + "px",
                    left: "-" + shadow + "px",
                    top: size + "px"
                })
            });

            $($this).trigger("resize");


            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {
//console.log(self.color.c + " --- "+ event.color.c)
                //console.log(self.color.c_from + " --- "+ event.color.c_from)
                vis.binds.plumb.check(id, event)
            });

        },
        tpice_vl: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conLeft", "conTop", "conBottom"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];

            self.conTop = data.conTop || null;
            self.conRight = data.conRight || null;
            self.conBottom = data.conBottom || null;

            $($this).on("resize", function () {
                var size = Math.round($this.height() / 3);
                var shadow = parseInt($this.width() / 3 / 2);

                $($this).find(".tpice-vt").css({"box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px  ' + shadow + 'px -' + shadow + 'px #000'})
                $($this).find(".tpice-vml").css({"box-shadow": 'inset -' + shadow + 'px 0px  ' + shadow + 'px -' + shadow + 'px #000'});
                $($this).find(".tpice-vb").css({"box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px  ' + shadow + 'px -' + shadow + 'px #000'})

                $($this).find(".bogen_tl_shadow").css({"box-shadow": '0px 0px ' + parseInt(shadow / 1) + 'px ' + parseInt(shadow / 5) + 'px #000 '});
                $($this).find(".bogen_bl_shadow").css({"box-shadow": '0px 0px ' + parseInt(shadow / 1) + 'px ' + parseInt(shadow / 5) + 'px#000 '});

                $($this).find(".tpice-vl").css({"box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px  -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'})


                $($this).find(" .bogen_tl_shadow").css({
                    height: shadow + "px",
                    width: shadow + "px",
                    left: "-" + shadow - 1 + "px",
                    top: size + "px"
                });
                $($this).find(".bogen_bl_shadow").css({
                    height: shadow + "px",
                    width: shadow + "px",
                    left: "-" + shadow + "px",
                    bottom: size + "px"
                })
            });

            $($this).trigger("resize");

            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {
                vis.binds.plumb.check(id, event)
            });

        },
        tpice_vr: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pipe",
                    cons: ["conRight", "conTop", "conBottom"],
                    coli: false,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false,
                    color: {
                        c: null,
                        c_from: null,
                        c_default: null
                    }
                }
            }
            var self = plumb[id];

            self.conBottom = data.conBottom || null;
            self.conRight = data.conRight || null;
            self.conTop = data.conTop || null;

            $($this).on("resize", function () {
                var size = Math.round($this.height() / 3);
                var shadow = parseInt($this.width() / 3 / 2);

                $($this).find(".tpice-vt").css({"box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px  ' + shadow + 'px -' + shadow + 'px #000'});
                $($this).find(".tpice-vmr").css({"box-shadow": 'inset ' + shadow + 'px 0px  ' + shadow + 'px -' + shadow + 'px #000'});
                $($this).find(".tpice-vb").css({"box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px  ' + shadow + 'px -' + shadow + 'px #000'});

                $($this).find(".bogen_tr_shadow").css({"box-shadow": '0px 0px ' + parseInt(shadow / 1) + 'px ' + parseInt(shadow / 5) + 'px #000 '});
                $($this).find(".bogen_br_shadow").css({"box-shadow": '0px 0px ' + parseInt(shadow / 1) + 'px ' + parseInt(shadow / 5) + 'px#000 '});

                $($this).find(".tpice-vr").css({"box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px  -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'});

                $($this).find(" .bogen_tr_shadow").css({
                    height: shadow + "px",
                    width: shadow + "px",
                    right: "-" + shadow - 1 + "px",
                    top: size + "px"
                });
                $($this).find(".bogen_br_shadow").css({
                    height: shadow + "px",
                    width: shadow + "px",
                    right: "-" + shadow + "px",
                    bottom: size + "px"
                })


            });

            $($this).trigger("resize")


            vis.binds.plumb.plumb_drop($this);

            $this.bind("plumb_change", function (event) {
                vis.binds.plumb.check(id, event)
            });

        },
        ent_e_top: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pump",
                    cons: ["conTop", "conBottom", "conLeft", "conRight"],
                    coli: false,
                    from: id,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false
                }
            }
            var self = plumb[id];

            self.conLeft = data.conLeft || null;
            self.conRight = data.conRight || null;
            self.conTop = data.conTop || null;
            self.conBottom = data.conBottom || null;

            vis.binds.plumb.plumb_drop($this);

            $($this).on("resize", function () {
                var shadow = parseInt($this.width()/2) - 20;
                $($this).find(".ent-e_center").css({"box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000'});
                $($this).find(".ent-e_bottom").css({"box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000'});
                $($this).find(".ent-e_top").css({"box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + (shadow) + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + (shadow) + 'px #000,inset  0px ' + (shadow / 2) + 'px ' + (shadow / 2) + 'px -' + (shadow / 2) + 'px #000'});

                var shadow_pips_t = parseInt($($this).find(".ent-e_top_pipe-l").width() / 2);

                $($this).find(".ent-e_top_pipe-l").css({"box-shadow": 'inset ' + shadow_pips_t + 'px 0px ' + shadow_pips_t + 'px -' + shadow_pips_t + 'px #000,inset -' + shadow_pips_t + 'px 0px ' + shadow_pips_t + 'px -' + shadow_pips_t + 'px #000'})
                $($this).find(".ent-e_top_pipe-r").css({"box-shadow": 'inset ' + shadow_pips_t + 'px 0px ' + shadow_pips_t + 'px -' + shadow_pips_t + 'px #000,inset -' + shadow_pips_t + 'px 0px ' + shadow_pips_t + 'px -' + shadow_pips_t + 'px #000'})
            });

            $this.bind("plumb_change", function (event) {


            });
        },
        tank_simple: function (el, data) {
            var $this = $(el).parent();
            var id = $this.attr("id");
            var plumb = vis.binds.plumb.data;

            if (!plumb[id]) {
                vis.binds.plumb.data[id] = {
                    type: "pump",
                    cons: [],
                    coli: false,
                    from: id,
                    conLeft: null,
                    conRight: null,
                    conTop: null,
                    conBottom: null,
                    status: false
                }
            }
            var self = plumb[id];

            self.conLeft = data.conLeft || null;
            self.conRight = data.conRight || null;
            self.conTop = data.conTop || null;
            self.conBottom = data.conBottom || null;

            vis.binds.plumb.plumb_drop($this);



            $this.find(".tank_simple_svg").append('\
            <svg \
            width="100%"\height="100%"\
            preserveAspectRatio="none"\
            viewBox="0 0 300 600">\
            <defs>\
            <clipPath id="f" clipPathUnits="userSpaceOnUse">\
            <path d="m150-0.142a150 100 0 0 0 -150 100l0.0025 400a150 100 0 0 0 75 86 150 100 0 0 0 150 0 150 100 0 0 0 75 -86v-400a150 100 0 0 0 -150 -100z" fill="'+ data.color +'"/>\
            </clipPath>\
            <linearGradient id="g" gradientUnits="userSpaceOnUse" y1="300" x2="300" y2="300">\
            <stop stop-color="#000000" stop-opacity=".5" offset="0"/>\
            <stop stop-color="#ffffff" stop-opacity=".302" offset=".5"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            </linearGradient>\
            <linearGradient id="a">\
            <stop stop-color="#ffffff" stop-opacity=".3" offset="0"/>\
            <stop stop-color="#000000" stop-opacity=".5" offset="1"/>\
            </linearGradient>\
            <radialGradient id="i" xlink:href="#a" gradientUnits="userSpaceOnUse" cy="400" cx="150" gradientTransform="matrix(-1 0 0 -.893 300 857)" r="150"/>\
            <radialGradient id="h" xlink:href="#a" gradientUnits="userSpaceOnUse" cy="200" cx="150" gradientTransform="matrix(1 0 0 .893 .005 -87.2)" r="150"/>\
            </defs>\
            <path d="m150-0.142a150 100 0 0 0 -150 100l0.0025 400a150 100 0 0 0 75 86 150 100 0 0 0 150 0 150 100 0 0 0 75 -86v-400a150 100 0 0 0 -150 -100z" fill="'+ data.color +'"/>\
            <rect id="'+data.wid+'_fill" style="color:#000000" clip-path="url(#f)" height="300" width="300" y="300" x="0" fill="'+ data.water_color +'"/>\
            <path fill="url(#g)" d="m0 100h300v400h-300z"  />\
            <path fill="url(#i)" d="m300 500a150 100 0 0 1 -75 87 150 100 0 0 1 -150 0 150 100 0 0 1 -75 -87h150z" />\
            <path fill="url(#h)" d="m0   100a150 100 0 0 1 150 -100 150 100 0 0 1 150 100h-150z"/>\
            </svg>\
            ');
            setTimeout(function () {

                if(vis.editMode){
                    if(data.type == "level"){
                        $("#inspect_fix").parent().parent().hide();
                        $("#inspect_level_min").parent().parent().show();
                        $("#inspect_level_max").parent().parent().show();
                        $("#inspect_bool_on").parent().parent().hide();
                        $("#inspect_bool_off").parent().parent().hide();
                        $("#inspect_oid").parent().parent().show();
                        $("#inspect_oid_desc").parent().parent().show();
                    }
                    if(data.type == "fix"){
                        $("#inspect_fix").parent().parent().show();
                        $("#inspect_level_min").parent().parent().hide();
                        $("#inspect_level_max").parent().parent().hide();
                        $("#inspect_bool_on").parent().parent().hide();
                        $("#inspect_bool_off").parent().parent().hide();
                        $("#inspect_oid").parent().parent().hide();
                        $("#inspect_oid_desc").parent().parent().hide();
                    }
                    if(data.type == "bool"){
                        $("#inspect_fix").parent().parent().hide();
                        $("#inspect_level_min").parent().parent().hide();
                        $("#inspect_level_max").parent().parent().hide();
                        $("#inspect_bool_on").parent().parent().show();
                        $("#inspect_bool_off").parent().parent().show();
                        $("#inspect_oid").parent().parent().show();
                        $("#inspect_oid_desc").parent().parent().show();
                    }
                }

                $this.find(".plumb_dock_right, .plumb_dock_left, .plumb_dock_top, .plumb_dock_bottom").remove();
                var l;
                var t;
                var s;
                var shadow;

                if (data.conTop_show == true) {
                    self.cons.push("conTop");
                    $this.find(".tank_simple").append('<div class="plumb_dock_top"></div>');
                    s = (data.conTop_size || 20);
                    t = "-10";
                    l = (($this.width() - s) / 100 * (data.conTop_pos || 50));
                    shadow = s / 2;
                    $this.find(".plumb_dock_top").css({
                        top: t + "px",
                        left: l + "px",
                        height: "80px",
                        width: s + "px",
                        background: "silver",
                        "box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000'
                    })
                }
                if (data.conBottom_show == true) {
                    self.cons.push("conBottom");
                    $this.find(".tank_simple").append('<div class="plumb_dock_bottom"></div>');
                    s = (data.conBottom_size || 20);
                    t = "-10";
                    l = (($this.width() - s) / 100 * (data.conBottom_pos || 50));
                    shadow = s / 2;
                    $this.find(".plumb_dock_bottom").css({
                        bottom: t + "px",
                        left: l + "px",
                        height: "80px",
                        width: s + "px",
                        background: "silver",
                        "box-shadow": 'inset ' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000,inset -' + shadow + 'px 0px ' + shadow + 'px -' + shadow + 'px #000'
                    })
                }
                if (data.conLeft_show == true) {
                    self.cons.push("conLeft");
                    $this.find(".tank_simple").append('<div class="plumb_dock_left"></div>');
                    s = (data.conLeft_size || 20);
                    l = "-10";
                    t = (($this.height() - s) / 100 * (data.conLeft_pos || 50));
                    shadow = s / 2;
                    $this.find(".plumb_dock_left").css({
                        top: t + "px",
                        left: l + "px",
                        height: s + "px",
                        width: "80px",
                        background: "silver",
                        "box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'
                    })
                }
                if (data.conRight_show == true) {
                    self.cons.push("conRight")
                    $this.find(".tank_simple").append('<div class="plumb_dock_right"></div>');
                    s = (data.conRight_size || 20);
                    l = "-10";
                    t = (($this.height() - s) / 100 * (data.conRight_pos || 50));
                    shadow = s / 2;
                    $this.find(".plumb_dock_right").css({
                        top: t + "px",
                        right: l + "px",
                        height: s + "px",
                        width: "80px",
                        background: "silver",
                        "box-shadow": 'inset 0px ' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000,inset 0px -' + shadow + 'px ' + shadow + 'px -' + shadow + 'px #000'
                    })
                }

                vis.binds.plumb.plumb_drop($this);

                if (data.oid != ""){
                    set(vis.states[data.oid + '.val'])
                }
            });


            vis.states.bind(data.oid + '.val', function (e, newVal, oldVal) {

                set(newVal)

            });

            function set(newVal) {
                var step = 600 / 100;
                var val;
                if(data.type == "level"){
                  step = 600 / (data.level_max - data.level_min);
                  val = (newVal - data.level_min) * step;

                    $("#"+ data.wid +"_fill").attr("height", val).attr("y", 600 -  val);

                }else
                if(data.type == "bool"){
                     step = 600 / 100;

                    if (newVal == true){
                        val = data.bool_on *step;
                    }else{
                        val = data.bool_off *step;
                    }

                    $("#"+ data.wid +"_fill").attr("height", val).attr("y", 600 - val);

                }else
                if(data.type == "fix"){

                    $("#"+ data.wid +"_fill").attr("height", data.fix *step).attr("y", 600 - data.fix *step);
                }
            }

            $this.bind("plumb_change", function (event) {
            });
        }
    }
</script>

<script id="tplPlump_pump"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_pump" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl_b pl_t ui-selectee ui-draggable-handle " data-vis-resizable="{}" style="top: 163px; left: 449px; width: 57px; height: 183px;" > <div class="vis-widget-prev-body">			<div class="pump" style=""><img style="position: absolute; width: 100%;" src="./widgets/plumb/img/pumpe.png"><div class="plumb_dock_top ui-droppable"></div><div class="plumb_dock_bottom ui-droppable"></div>				<div class="plumb_dock_left ui-droppable"></div>				<div class="plumb_dock_right ui-droppable"></div>			</div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="Pump"
        data-vis-attrs="oid;src[./widgets/plumb/img/pumpe.png];color_off[#C0C0C0]/color;color_on[#00ff00]/color;group.conTop;conTop_show/checkbox;conTop_size[20]/slider,5,50,5;conTop_pos[50]/slider,0,100,1;conTop;group.conBottom;conBottom_show/checkbox;conBottom_size[20]/slider,5,50,5;conBottom_pos[50]/slider,0,100,1;conBottom;group.conLeft;conLeft_show/checkbox;conLeft_size[20]/slider,5,50,5;conLeft_pos[50]/slider,0,100,1;conLeft;group.conRight;conRight_show/checkbox;conRight_size[20]/slider,5,50,5;conRight_pos[50]/slider,0,100,1;conRight">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_b pl_t pl_l pl_r" data-vis-resizable='{}' style=" width: 65px; height: 205px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.pump(el, data) %>>
			<div class="pump" style="">
			   <% if (vis.editMode) { %>
                <div class="editmode-helper" style="z-index:0" />
            <% } %>
            <img class="pump_img" <%= this.data.attr('src') ? 'src="' + this.data.attr('src') + '"' : '' %> />
				<div class="plumb_dock_top"></div>
				<div class="plumb_dock_bottom"></div>
				<div class="plumb_dock_left"></div>
				<div class="plumb_dock_right"></div>
			</div>
        </div>
    </div>


</script>

<script id="tplPlump_i-strinkler"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_istrinkler" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_b pl_t pl_l pl_r ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 10 ]}" style="width: 20px; height: 17px; overflow: visible; left: 242px; top: 228px; position: absolute;" > <div class="plumb_sprinkler_i_body vis-widget-prev-body" style="border-top-left-radius: 100%; border-top-right-radius: 100%; border-bottom-right-radius: 100%; border-bottom-left-radius: 100%; background-color: rgb(0, 0, 0);"> <div class="plumb_sprinkler_i" style=""> <div class="plumb_splinkler_i_water" style="height: 60px; width: 5px; left: 7px; top: -51px; position: relative; background-color: rgb(27, 138, 222);"></div> </div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_bottom ui-droppable"></div> <div class="plumb_dock_left ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="Sprinker I"
        data-vis-attrs="test/checkbox;width[100];time[4];start[0];ende[90];stroke[4];opacity[0.8];fog/checkbox;water_color[blue]/color;head_color[black]/color;head_show[true]/checkbox;head_round[true]/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_b pl_t pl_l pl_r" data-vis-resizable='{"grid": [ 10, 10 ],"handles": "s, e"}' style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="plumb_sprinkler_i_body vis-widget-body" <%= (el) -> vis.binds.plumb.sprinkler_i(el, data) %>>
				<div class="plumb_sprinkler_i" style="display: 'none'">
				<div class="plumb_sprinkler_i_water"></div>
				</div>
            	<div class="plumb_dock_top"></div>
				<div class="plumb_dock_bottom"></div>
				<div class="plumb_dock_left"></div>
				<div class="plumb_dock_right"></div>
        </div>
    </div>


</script>

<script id="tplPlump_r-strinkler"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_istrinkler" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_b pl_t pl_l pl_r ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 10 ]}" style="width: 20px; height: 17px; overflow: visible; left: 242px; top: 228px; position: absolute;" > <div class="plumb_sprinkler_i_body vis-widget-prev-body" style="border-top-left-radius: 100%; border-top-right-radius: 100%; border-bottom-right-radius: 100%; border-bottom-left-radius: 100%; background-color: rgb(0, 0, 0);"> <div class="plumb_sprinkler_i" style=""> <div class="plumb_splinkler_i_water" style="height: 60px; width: 5px; left: 7px; top: -51px; position: relative; background-color: rgb(27, 138, 222);"></div> </div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_bottom ui-droppable"></div> <div class="plumb_dock_left ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="Sprinker R"
        data-vis-attrs="position[center]/nselect,center,top-center,bottom-center,left-center,right-center,top-left,top-right,bottom-left,bottom-right;test/checkbox;width[100];time[30];start[0];ende[90];stroke[4];opacity[0.8];fog/checkbox;water_color[blue]/color;head_color[black]/color;head_show[true]/checkbox;head_round[true]/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_b pl_t pl_l pl_r" data-vis-resizable='{"grid": [ 10, 10 ],"aspectRatio": true,"handles": "s, e"}' style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="plumb_sprinkler_r_body vis-widget-body" <%= (el) -> vis.binds.plumb.sprinkler_r(el, data) %>>
				<div class="plumb_sprinkler_r" style="display: 'none'">
				<div class="plumb_sprinkler_r_water"></div>
				</div>
            	<div class="plumb_dock_top"></div>
				<div class="plumb_dock_bottom"></div>
				<div class="plumb_dock_left"></div>
				<div class="plumb_dock_right"></div>
        </div>
    </div>


</script>

<script id="tplPlump_pipe_V"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_pipe_V" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee ui-draggable-handle " style="top: 238px; left: 82px; width: 20px; height: 100px;" > <div class="vis-widget-prev-body">			<div class="pipe_v" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;">				<div class="plumb_dock_top"></div>				<div class="plumb_dock_bottom"></div>			</div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_V"
        data-vis-attrs="conTop;conBottom">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_b pl_t" data-vis-resizable='{"grid": [ 5, 1 ],"handles": "all" }' style="width: 20px; height: 100px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.pipe_v(el, data.conTop, data.conBottom) %>>
			<div class="pipe_v plumb_body" style="">
				<div class="plumb_dock_top"></div>
				<div class="plumb_dock_bottom"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_pipe_H"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_pipe_H" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee ui-draggable-handle " style="top: 203px; left: 181px; width: 100px; height: 20px;" > <div class="vis-widget-prev-body">			<div class="pipe_v" style="box-shadow: rgb(0, 0, 0) 0px 10px 10px -10px inset, rgb(0, 0, 0) 0px -10px 10px -10px inset;">				<div class="plumb_dock_top"></div>				<div class="plumb_dock_bottom"></div>			</div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_H"
        data-vis-attrs="conLeft;conRight">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r " data-vis-resizable='{"grid": [ 1, 5 ]}' style=" width: 100px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.pipe_h(el, data.conLeft, data.conRight) %>>
			<div class="pipe_h plumb_body" style="">
				<div class="plumb_dock_left"></div>
				<div class="plumb_dock_right"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_bogen_br"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_bogen_br" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev ui-selectee ui-draggable-handle " style="top: 186px; left: 85px; width: 20px; height: 20px;" > <div class="vis-widget-prev-body">			<div class="bogen_br" style="box-shadow: rgb(0, 0, 0) 5px 5px 10px -6px inset;">				<div class="bogen_br_shadow" style="box-shadow: rgb(0, 0, 0) -2px -2px 10px;"></div>				<div class="plumb_dock_right"></div>				<div class="plumb_dock_bottom"></div>			</div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Bogen_br"
        data-vis-attrs="conBottom;conRight">
    <div class="vis-widget <%== this.data.attr('class')%>  pl pl_r pl_b " data-vis-resizable='{"grid": [ 10, 10 ],"aspectRatio": true, "handles": "s,e" }' style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.bogen_br(el, data.conBottom, data.conRight) %>>
			<div class="bogen_br plumb_body">
				<div class="bogen_br_shadow"></div>
				<div class="plumb_dock_right"></div>
				<div class="plumb_dock_bottom"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_bogen_bl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_bogen_bl" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl_l pl_b ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 10 ],"aspectRatio": true, "handles": "s,e" }" style="top: 252px; left: 147px; width: 20px; height: 20px;" > <div class="vis-widget-prev-body">			<div class="bogen_bl" style="box-shadow: rgb(0, 0, 0) -5px 5px 10px -6px inset;">				<div class="bogen_bl_shadow" style="box-shadow: rgb(0, 0, 0) 2px -2px 10px;"></div>				<div class="plumb_dock_left ui-droppable"></div>				<div class="plumb_dock_bottom ui-droppable"></div>			</div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Bogen_bl"
        data-vis-attrs="conBottom;conLeft">
    <div class="vis-widget <%== this.data.attr('class')%>  pl pl_l pl_b " data-vis-resizable='{"grid": [ 10, 10 ],"aspectRatio": true, "handles": "s,e" }' style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.bogen_bl(el, data.conBottom, data.conLeft) %>>
			<div class="bogen_bl plumb_body">
				<div class="bogen_bl_shadow"></div>
				<div class="plumb_dock_left"></div>
				<div class="plumb_dock_bottom"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_bogen_tr"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_bogen_tr" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl_t pl_r ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 10 ],"aspectRatio": true, "handles": "s,e" }" style="top: 537px; left: 288px; width: 20px; height: 20px;" > <div class="vis-widget-prev-body">			<div class="bogen_tr">				<div class="bogen_tr_shadow"></div>				<div class="plumb_dock_top ui-droppable"></div>				<div class="plumb_dock_right ui-droppable"></div>			</div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Bogen_tr"
        data-vis-attrs="conTop;conRight">
    <div class="vis-widget <%== this.data.attr('class')%>  pl pl_t pl_r " data-vis-resizable='{"grid": [ 10, 10 ],"aspectRatio": true, "handles": "s,e" }' style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.bogen_tr(el, data.conTop, data.conRight) %>>
			<div class="bogen_tr plumb_body">
				<div class="bogen_tr_shadow"></div>
				<div class="plumb_dock_top"></div>
				<div class="plumb_dock_right"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_bogen_tl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_bogen_tl" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl_t pl_l ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 10 ],"aspectRatio": true, "handles": "s,e" }" style="top: 515px; left: 147px; width: 20px; height: 20px;" > <div class="vis-widget-prev-body">			<div class="bogen_tl">				<div class="bogen_tl_shadow"></div>				<div class="plumb_dock_top ui-droppable"></div>				<div class="plumb_dock_left ui-droppable"></div>			</div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Bogen_tl"
        data-vis-attrs="conTop;conLeft">
    <div class="vis-widget <%== this.data.attr('class')%>  pl pl_t pl_l " data-vis-resizable='{"grid": [ 10, 10 ],"aspectRatio": true, "handles": "s,e" }' style=" width: 20px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.bogen_tl(el, data.conTop, data.conLeft) %>>
			<div class="bogen_tl plumb_body">
				<div class="bogen_tl_shadow"></div>
				<div class="plumb_dock_top"></div>
				<div class="plumb_dock_left"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_valve_H"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_valve_H" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl_l pl_r ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 20, 10 ],"aspectRatio": true}" style="top: 245px; left: 240px; width: 40px; height: 20px;" > <div class="vis-widget-prev-body">   <div class="valve_h" style="">    <div class="plumb_valve_l" style="border-color: rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgb(255, 0, 0); border-width: 10px 0px 10px 20px;"></div>    <div class="plumb_valve_r" style="border-color: rgba(0, 0, 0, 0) rgb(255, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0); border-width: 10px 20px 10px 0px;"></div>    <div class="plumb_dock_left ui-droppable"></div>    <div class="plumb_dock_right ui-droppable"></div>   </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="valve_H"
        data-vis-attrs="oid;conLeft;conRight;ctrl/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r " data-vis-resizable='{"grid": [ 10, 5 ],"aspectRatio": true}' style=" width: 40px; height: 20px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.valve_h(el, data.oid, data.conLeft, data.conRight, data.ctrl) %>>
			<div class="valve_h " style="">
			    <div class="plumb_valve_l"></div>
			    <div class="plumb_valve_r"></div>
				<div class="plumb_dock_left"></div>
				<div class="plumb_dock_right"></div>
			</div>
        </div>
    </div>
</script>

<script id="tplPlump_valve_V"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_valve_v" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl_t pl_b ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 20 ],"aspectRatio": true}" style="width: 20px; height: 35px; left: 121px; top: 469px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="valve_v " style=""> <div class="plumb_valve_t" style="border-color: rgb(255, 0, 0) rgba(0, 0, 0, 0) rgba(0, 0, 0, 0); border-width: 20px 10px 0px;"></div> <div class="plumb_valve_b" style="border-color: rgba(0, 0, 0, 0) rgba(0, 0, 0, 0) rgb(255, 0, 0); border-width: 0px 10px 20px;"></div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_bottom ui-droppable"></div> </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="valve_V"
        data-vis-attrs="oid;conLeft;conRight;ctrl/checkbox">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_t pl_b " data-vis-resizable='{"grid": [ 5, 10 ],"aspectRatio": true}' style=" width: 20px; height: 40px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.valve_v(el, data.oid, data.conTop, data.conBottom, data.ctrl) %>>
			<div class="valve_v " style="">
			    <div class="plumb_valve_t"></div>
			    <div class="plumb_valve_b"></div>
				<div class="plumb_dock_top"></div>
				<div class="plumb_dock_bottom"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_check_valve_H"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_check_valve_H" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_l pl_r ui-selectee ui-selected ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 5 ],"aspectRatio": true}" style="width: 40px; height: 20px; left: 272px; top: 88px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="valve_h " style=""> <div class="plumb_c_valve_h_img" style="background-position: initial initial; background-repeat: initial initial;"></div> <div class="plumb_c_valve_h_back_l" style="display: block; width: 50%; height: 100%; position: absolute; background-color: silver; box-shadow: rgb(0, 0, 0) 0px 10px 10px -10px inset, rgb(0, 0, 0) 0px -10px 10px -10px inset; background-position: initial initial; background-repeat: initial initial;"></div> <div class="plumb_c_valve_h_back_r" style="display: block; width: 50%; height: 100%; position: absolute; background-color: silver; box-shadow: rgb(0, 0, 0) 0px 10px 10px -10px inset, rgb(0, 0, 0) 0px -10px 10px -10px inset; right: 0px; background-position: initial initial; background-repeat: initial initial;"></div> <div class="plumb_dock_left ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="Check Valve H"
        data-vis-attrs="conLeft;conRight;show_back[true]/checkbox;symbol[./widgets/plumb/img/c_valve_h.svg]/src;turn_direction/checkbox">
         <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r " data-vis-resizable='{"grid": [ 10, 5 ],"aspectRatio": true}' style=" width: 40px; height: 20px;" id="<%= this.data.attr('wid') %>">
             <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.c_valve_h(el, data) %>>
    			<div class="valve_h " style="">
    			    <div class="plumb_c_valve_h_img"></div>
    			    <div class="plumb_c_valve_h_back_l"></div>
    			    <div class="plumb_c_valve_h_back_r"></div>
    				<div class="plumb_dock_left"></div>
    				<div class="plumb_dock_right"></div>
    			</div>
             </div>
         </div>
</script>

<script id="tplPlump_check_valve_V"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_check_valve_V" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_t pl_b ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 5, 10 ],"aspectRatio": true}" style="width: 20px; height: 40px; left: 513px; top: 189px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="valve_v " style=""> <div class="plumb_c_valve_v_img" style="background-image: url(http://localhost:63342/ioBroker.vis/widgets/plumb/img/c_valve_v.svg); background-position: initial initial; background-repeat: initial initial;"></div> <div class="plumb_c_valve_v_back_t" style="display: block; box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;"></div> <div class="plumb_c_valve_v_back_b" style="display: block; box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;"></div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_bottom ui-droppable"></div> </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="val"
        data-vis-name="Check Valve V"
        data-vis-attrs="conTop;conBottom;show_back[true]/checkbox;symbol[./widgets/plumb/img/c_valve_v.svg]/src;turn_direction/checkbox">
         <div class="vis-widget <%== this.data.attr('class') %> pl pl_t pl_b " data-vis-resizable='{"grid": [ 5, 10 ],"aspectRatio": true}' style=" width: 20px; height: 40px;" id="<%= this.data.attr('wid') %>">
             <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.c_valve_v(el, data) %>>
    			<div class="valve_v " style="">
    			    <div class="plumb_c_valve_v_img"></div>
    			    <div class="plumb_c_valve_v_back_t"></div>
    			    <div class="plumb_c_valve_v_back_b"></div>
    				<div class="plumb_dock_top"></div>
    				<div class="plumb_dock_bottom"></div>
    			</div>
             </div>
         </div>
</script>

<script id="tplPlump_Tpiece_ht"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_Tpiece_ht" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl_l pl_r pl_t ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 30, 30 ],"aspectRatio": true}" style="width: 60px; height: 60px; left: 372px; top: 579px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="tpice_ht " style=""> <div class="tpice-hl plumb_body"></div> <div class="tpice-hm plumb_body"> <div class="bogen_tl_shadow"></div> <div class="bogen_tr_shadow"></div> </div> <div class="tpice-hr plumb_body"></div> <div class="tpice-t plumb_body"></div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_left ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_HT"
        data-vis-attrs="conLeft;conRight;conTop">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r pl_t" data-vis-resizable='{"grid": [ 30, 30 ],"aspectRatio": true}' style="width: 60px; height: 60px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.tpice_ht(el, data) %>>
			<div class="tpice_ht " style="">
			    <div class="tpice-hl plumb_body"></div>
			    <div class="tpice-hm plumb_body">
                    <div class="bogen_tl_shadow"></div>
                    <div class="bogen_tr_shadow"></div>
			    </div>
			    <div class="tpice-hr plumb_body"></div>
			    <div class="tpice-t plumb_body"></div>
				<div class="plumb_dock_top"></div>
				<div class="plumb_dock_left"></div>
				<div class="plumb_dock_right"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_Tpiece_hb"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_Tpiece_hb" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_l pl_r pl_t ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 30, 30 ],"aspectRatio": true}" style="width: 60px; height: 60px; left: 533px; top: 567px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="tpice_ht " style=""> <div class="tpice-hl plumb_body" style="box-shadow: rgb(0, 0, 0) 0px 10px 10px -10px inset, rgb(0, 0, 0) 0px -10px 10px -10px inset; height: 20px; width: 20px;"></div> <div class="tpice-hm plumb_body" style="box-shadow: rgb(0, 0, 0) 0px 10px 10px -10px inset; height: 20px; width: 20px;"> <div class="bogen_bl_shadow" style="box-shadow: rgb(0, 0, 0) 0px 0px 10px 2px; height: 10px; width: 10px; left: -10px; top: 20px;"></div> <div class="bogen_br_shadow" style="box-shadow: rgb(0, 0, 0) 0px 0px 10px 2px; height: 10px; width: 10px; right: -11px; top: 20px;"></div> </div> <div class="tpice-hr plumb_body" style="box-shadow: rgb(0, 0, 0) 0px 10px 10px -10px inset, rgb(0, 0, 0) 0px -10px 10px -10px inset; height: 20px; width: 20px;"></div> <div class="tpice-b plumb_body" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset; height: 20px; width: 20px;"></div> <div class="plumb_dock_bottom ui-droppable"></div> <div class="plumb_dock_left ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_HB"
        data-vis-attrs="conLeft;conRight;conBottom">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r pl_t" data-vis-resizable='{"grid": [ 30, 30 ],"aspectRatio": true}' style="width: 60px; height: 60px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.tpice_hb(el, data) %>>
			<div class="tpice_ht " style="">
			    <div class="tpice-hl plumb_body"></div>
			    <div class="tpice-hm plumb_body">
                    <div class="bogen_bl_shadow"></div>
                    <div class="bogen_br_shadow"></div>
			    </div>
			    <div class="tpice-hr plumb_body"></div>
			    <div class="tpice-b plumb_body"></div>
				<div class="plumb_dock_bottom"></div>
				<div class="plumb_dock_left"></div>
				<div class="plumb_dock_right"></div>
			</div>
        </div>
    </div>


</script>

<script id="tplPlump_Tpiece_vl"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_Tpiece_vl" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_l pl_r pl_t ui-draggable-handle " data-vis-resizable="{"grid": [ 30, 30 ],"aspectRatio": true}" style="width: 60px; height: 60px; left: 173px; top: 431px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="tpice_vl " style=""> <div class="tpice-vl plumb_body" style="box-shadow: rgb(0, 0, 0) 0px 10px 10px -10px inset, rgb(0, 0, 0) 0px -10px 10px -10px inset;"></div> <div class="tpice-vt plumb_body" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;"></div> <div class="tpice-vml plumb_body"> <div class="bogen_tl_shadow" style="box-shadow: rgb(0, 0, 0) 0px 0px 10px 2px; height: 10px; width: 10px; left: -11px; top: 20px;"></div> <div class="bogen_bl_shadow" style="box-shadow: rgb(0, 0, 0) 0px 0px 10px 2px; height: 10px; width: 10px; left: -10px; bottom: 20px;"></div> </div> <div class="tpice-vb plumb_body" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;"></div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_left ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_VL"
        data-vis-attrs="conLeft;conBottom;conTop">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r pl_t" data-vis-resizable='{"grid": [ 30, 30 ],"aspectRatio": true}' style="width: 60px; height: 60px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.tpice_vl(el, data) %>>
			<div class="tpice_vl " style="">
			    <div class="tpice-vl plumb_body"></div>
			     <div class="tpice-vt plumb_body"></div>
			    <div class="tpice-vml plumb_body">
                    <div class="bogen_tl_shadow"></div>
                    <div class="bogen_bl_shadow"></div>
			    </div>

			    <div class="tpice-vb plumb_body"></div>
				<div class="plumb_dock_top"></div>
				<div class="plumb_dock_bottom"></div>
				<div class="plumb_dock_left"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_Tpiece_vr"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_Tpiece_vr" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_b pl_r pl_t ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 30, 30 ],"aspectRatio": true}" style="width: 60px; height: 60px; left: 337.0000228881836px; top: 261.00000762939453px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="tpice_vl " style=""> <div class="tpice-vr plumb_body" style="box-shadow: rgb(0, 0, 0) 0px 10px 10px -10px inset, rgb(0, 0, 0) 0px -10px 10px -10px inset;"></div> <div class="tpice-vt plumb_body" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;"></div> <div class="tpice-vmr plumb_body" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset;"> <div class="bogen_tr_shadow" style="box-shadow: rgb(0, 0, 0) 0px 0px 10px 2px; height: 10px; width: 10px; right: -11px; top: 20px;"></div> <div class="bogen_br_shadow" style="box-shadow: rgb(0, 0, 0) 0px 0px 10px 2px; height: 10px; width: 10px; right: -10px; bottom: 20px;"></div> </div> <div class="tpice-vb plumb_body" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;"></div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_bottom ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Pipe_VR"
        data-vis-attrs="conBottom;conRight;conTop">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_b pl_r pl_t" data-vis-resizable='{"grid": [ 30, 30 ],"aspectRatio": true}' style="width: 60px; height: 60px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.tpice_vr(el, data) %>>
			<div class="tpice_vl " style="">
			    <div class="tpice-vr plumb_body"></div>
			     <div class="tpice-vt plumb_body"></div>
			    <div class="tpice-vmr plumb_body">
                    <div class="bogen_tr_shadow"></div>
                    <div class="bogen_br_shadow"></div>
			    </div>
			    <div class="tpice-vb plumb_body"></div>
				<div class="plumb_dock_top"></div>
				<div class="plumb_dock_bottom"></div>
				<div class="plumb_dock_right"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_tank_ent_e"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_tank_ent_e" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_l pl_r pl_t ui-draggable-handle " data-vis-resizable="{"grid": [ 30, 30 ],"aspectRatio": true}" style="width: 110px; height: 240px; left: 330px; top: 47px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="tank_ent-e " style=""> <div class="ent-e_top_pipe-l" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;"></div> <div class="ent-e_top_pipe-r" style="box-shadow: rgb(0, 0, 0) 10px 0px 10px -10px inset, rgb(0, 0, 0) -10px 0px 10px -10px inset;"></div> <div class="ent-e_top" style="box-shadow: rgb(0, 0, 0) 90px 0px 90px -90px inset, rgb(0, 0, 0) -90px 0px 90px -90px inset, rgb(0, 0, 0) 0px 45px 45px -45px inset;"></div> <div class="ent-e_center" style="box-shadow: rgb(0, 0, 0) 90px 0px 90px -90px inset, rgb(0, 0, 0) -90px 0px 90px -90px inset;"> <div class="ent-e_schott"></div> <div class="ent-e_kies"></div> </div> <div class="ent-e_bottom" style="box-shadow: rgb(0, 0, 0) 90px 0px 90px -90px inset, rgb(0, 0, 0) -90px 0px 90px -90px inset;"></div> <div class="ent-e_bottom_pipe"></div> <div class="plumb_dock_top ui-droppable"></div> <div class="plumb_dock_left ui-droppable"></div> <div class="plumb_dock_right ui-droppable"></div> </div> </div> </div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Tank Enteisung"
        data-vis-attrs="conLeft;conRight;conTop;conBottom">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r pl_t" data-vis-resizable='{"grid": [ 50, 50 ],"aspectRatio": true}' style="min-width: 140px; min-height: 270px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.ent_e_top(el, data) %>>
			<div class="tank_ent-e " style="">
                <div class="ent-e_top_pipe-l plumb_dock_top"></div>
                <div class="ent-e_top_pipe-r plumb_dock_top"></div>
                <div class="ent-e_top">
                    <svg class="spray spray_l" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 50 50">
                        <defs>
                            <linearGradient x1="25" y1="0" x2="25" y2="50" id="linearGradient4318" xlink:href="#linearGradient3755" gradientUnits="userSpaceOnUse" />
                            <linearGradient id="linearGradient3755">
                                <stop offset="0" style="stop-color:#0000ff;stop-opacity:1" id="stop3757" />
                                <stop offset="1" style="stop-color:#bb5b0d;stop-opacity:1" id="stop3759" />
                            </linearGradient>
                        </defs>
                        <path style="stroke-dasharray:3,10,7; stroke:url(#linearGradient4318);stroke-width:0.5;stroke-linecap:none;stroke-opacity:1" d="M 50,50 25,0 M 45,50 25,0 M 40,50 25,0 M 35,50 25,0 M 30,50 25,0 M 25,50 25,0 M 20,50 25,0 M 15,50 25,0 M 10,50 25,0 M 5,50 25,0 M 0,50 25,0"></path>
                        <animate attributeName="stroke-dashoffset" begin="0s"  from="0" to="40" dur="1s"  repeatCount="indefinite"></animate>
                    </svg>
                    <svg class="spray spray_r" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 50 50">
                        <path style="stroke-dasharray:10,7,3; stroke:url(#linearGradient4318);stroke-width:0.5;stroke-linecap:none;stroke-opacity:1" d="M 50,50 25,0 M 45,50 25,0 M 40,50 25,0 M 35,50 25,0 M 30,50 25,0 M 25,50 25,0 M 20,50 25,0 M 15,50 25,0 M 10,50 25,0 M 5,50 25,0 M 0,50 25,0
                        "></path>
                        <animate attributeName="stroke-dashoffset" begin="0s"  from="0" to="40" dur="1s"  repeatCount="indefinite"></animate>
                    </svg>
                </div>
                <div class="ent-e_center">
                    <div class="ent-e_schott"></div>
                    <div class="ent-e_kies"></div>
                </div>
                <div class="ent-e_bottom"></div>
                <div class="ent-e_bottom_pipe"></div>

				<div class="plumb_dock_left"></div>
				<div class="plumb_dock_right"></div>
			</div>
        </div>
    </div>



</script>

<script id="tplPlump_tank_simple"
        type="text/ejs"
        class="vis-tpl"
        data-vis-prev='<div id="prev_tplPlump_tank_simple" style="position: relative; text-align: initial;padding: 4px "><div class="vis-widget_prev pl pl_l pl_r pl_t pl_b ui-selectee ui-draggable-handle " data-vis-resizable="{"grid": [ 10, 10 ],"aspectRatio": false}" style="min-width: 70px; min-height: 135px; left: 354px; top: 82px; width: 100px; height: 175px; position: absolute;" > <div class="vis-widget-prev-body"> <div class="tank_simple" style=""> <div class="tank_simple_svg"> <svg width="100%" height="100%" preserveAspectRatio="none" viewBox="0 0 300 600"> <defs> <clipPath clipPathUnits="userSpaceOnUse"> <path d="m150-0.172a150 100 0 0 0 -150 100l-0.0042 400a150 100 0 0 0 75 86 150 100 0 0 0 150 0 150 100 0 0 0 75 -86v-400a150 100 0 0 0 -150 -100z" fill="#C0C0C0"></path> </clipPath> <linearGradient gradientUnits="userSpaceOnUse" y1="300" x2="300" y2="300"> <stop stop-color="#000000" stop-opacity=".5" offset="0"></stop> <stop stop-color="#ffffff" stop-opacity=".302" offset=".5"></stop> <stop stop-color="#000000" stop-opacity=".5" offset="1"></stop> </linearGradient> <radialGradient xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#a" gradientUnits="userSpaceOnUse" cy="400" cx="150" gradientTransform="matrix(-1 0 0 -.893 300 857)" r="150"></radialGradient> <linearGradient > <stop stop-color="#ffffff" stop-opacity=".3" offset="0"></stop> <stop stop-color="#000000" stop-opacity=".5" offset="1"></stop> </linearGradient> <radialGradient xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#a" gradientUnits="userSpaceOnUse" cy="203" cx="150" gradientTransform="matrix(1 0 0 .893 .005 -87.2)" r="150"></radialGradient> </defs> <path d="m150-0.142a150 100 0 0 0 -150 100l0.0025 400a150 100 0 0 0 75 86 150 100 0 0 0 150 0 150 100 0 0 0 75 -86v-400a150 100 0 0 0 -150 -100z" fill="#C0C0C0"></path> <rect style="color:#000000" clip-path="url(#f)" height="480" width="300" y="120" x="0" fill="#0000ff"></rect> <path style="color:#000000" d="m0 100h300v400h-300z" fill="url(#g)"></path> <path style="color:#000000" d="m300 500a150 100 0 0 1 -75 86.75 150 100 0 0 1 -150 0 150 100 0 0 1 -75 -86.75h150z" stroke-width="0.1" fill="url(#i)"></path> <path style="color:#000000" fill="url(#h)" d="m0 99.85a150 100.1 0 0 1 150 -100 150 100.1 0 0 1 150 100h-150z"></path> </svg> </div> <div class="plumb_dock_left ui-droppable" style="top: 128px; left: -10px; height: 15px; width: 80px; box-shadow: rgb(0, 0, 0) 0px 7.5px 7.5px -7.5px inset, rgb(0, 0, 0) 0px -7.5px 7.5px -7.5px inset; background: silver;"></div><div class="plumb_dock_right ui-droppable" style="top: 32px; right: -10px; height: 15px; width: 80px; box-shadow: rgb(0, 0, 0) 0px 7.5px 7.5px -7.5px inset, rgb(0, 0, 0) 0px -7.5px 7.5px -7.5px inset; background: silver;"></div></div> </div></div></div>'
        data-vis-set="plumb"
        data-vis-type="static"
        data-vis-name="Tank"
        data-vis-attrs="type[level]/nselect,fix,bool,level;fix[50];bool_on[90];bool_off[20];level_min[0];level_max[0];oid;color[#C0C0C0]/color;water_color[#0000ff]/color;group.conTop;conTop_show/checkbox;conTop_size[20]/slider,5,50,5;conTop_pos[50]/slider,0,100,1;conTop;group.conBottom;conBottom_show/checkbox;conBottom_size[20]/slider,5,50,5;conBottom_pos[50]/slider,0,100,1;conBottom;group.conLeft;conLeft_show/checkbox;conLeft_size[20]/slider,5,50,5;conLeft_pos[50]/slider,0,100,1;conLeft;group.conRight;conRight_show/checkbox;conRight_size[20]/slider,5,50,5;conRight_pos[50]/slider,0,100,1;conRight">
    <div class="vis-widget <%== this.data.attr('class') %> pl pl_l pl_r pl_t pl_b" data-vis-resizable='{}' style="min-width: 70px; min-height: 135px;" id="<%= this.data.attr('wid') %>">
        <div class="vis-widget-body" <%= (el) -> vis.binds.plumb.tank_simple(el, data) %>>
			<div class="tank_simple" style="">
            	<div class="tank_simple_svg">
				<div class="plumb_dock_left"></div>
				<div class="plumb_dock_right"></div>
				<div class="plumb_dock_top"></div>
				<div class="plumb_dock_bottom"></div>
			</div>
        </div>
    </div>
</script>






